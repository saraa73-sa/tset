<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>بطاقة التسميع</title>
</head>
<body>
<form id="tasmeeForm">
<h2>بطاقة التسميع</h2>

<input id="name" placeholder="الاسم"><br><br>
<input id="lesson" placeholder="الدرس"><br><br>
<input id="review" placeholder="المراجعة"><br><br>

<label>من سورة:</label><br>
<input list="surahs" id="fromSurah"><br><br>

<label>إلى سورة:</label><br>
<input list="surahs" id="toSurah"><br><br>

<datalist id="surahs"></datalist>

<label>عدد الأوجه:</label><br>
<input id="faces" readonly><br><br>

<button type="submit">إرسال</button>

<p id="msg"></p>
</form>
<script>
const SURAH_PAGES = [
  { name: "الفاتحة", pages: 1 },
  { name: "البقرة", pages: 48 },
  { name: "آل عمران", pages: 50 },
  { name: "النساء", pages: 55 },
  { name: "المائدة", pages: 42 }
];

  const list = document.getElementById("surahs");

SURAH_PAGES.forEach(s => {
  const option = document.createElement("option");
  option.value = s.name;
  list.appendChild(option);
});

  function calculateFaces() {
  const from = document.getElementById("fromSurah").value;
  const to = document.getElementById("toSurah").value;

  const fromSurah = SURAH_PAGES.find(s => s.name === from);
  const toSurah = SURAH_PAGES.find(s => s.name === to);

  if (!fromSurah || !toSurah) return;

  const faces = Math.abs(toSurah.pages - fromSurah.pages) + 1;
  document.getElementById("faces").value = faces;
}

document.getElementById("fromSurah").addEventListener("change", calculateFaces);
document.getElementById("toSurah").addEventListener("change", calculateFaces);


document.getElementById("tasmeeForm").addEventListener("submit", function (e) {
  e.preventDefault();
  sendTasmee();
});

function sendTasmee() {
  console.log("زر الإرسال يعمل");

  const formData = new FormData(); // ✅ هذا السطر هو الحل

  formData.append("type", "tasmee");
  formData.append("name", document.getElementById("name").value);
  formData.append("lesson", document.getElementById("lesson").value);
  formData.append("review", document.getElementById("review").value);
  formData.append("faces", document.getElementById("faces").value);

  fetch("https://script.google.com/macros/s/AKfycbwC9TL0l8uPi0qPy_CMTxQh7w-Vvi52rWePBP3rABRnAYLUhgzaZUTOHsbl2gnzwANP/exec", {
    method: "POST",
    body: formData
  })
  .then(res => res.json())
  .then(() => {
    document.getElementById("msg").textContent =
      "تم إرسال بطاقة التسميع ✅";
  })
  .catch(err => {
    document.getElementById("msg").textContent =
      "فشل الإرسال ❌";
    console.error(err);
  });
}
</script>
</body>
</html>
  

