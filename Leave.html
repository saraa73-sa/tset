<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body { background:#f5f3ee; font-family:'Cairo', Tahoma, Arial; margin:0; padding:40px; }
.card { max-width:600px; margin:auto; background:#fff; border-radius:16px; box-shadow:0 15px 40px rgba(0,0,0,0.08); overflow:hidden; }
.header { background:linear-gradient(135deg,#065f46,#047857); color:white; text-align:center; padding:32px 20px; }
.header h1 { margin:0; font-size:28px; font-weight:700; }
.header p { margin-top:10px; font-size:14px; opacity:0.9; }
form { padding:30px; }
.field { margin-bottom:22px; }
label { display:block; font-weight:600; margin-bottom:6px; color:#064e3b; }
label span { color:#b91c1c; }
input[type="text"], input[type="date"] {
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid #d1d5db;
  font-family:'Cairo';
}
.radio-group label { display:block; margin-bottom:8px; cursor:pointer; }
.other-reason { display:none; margin-top:10px; }
button {
  width:100%;
  background:#065f46;
  color:white;
  border:none;
  padding:14px;
  border-radius:12px;
  font-size:16px;
  font-family:'Cairo';
  font-weight:600;
  cursor:pointer;
}
button:hover { background:#047857; }

.notification {
  display:none;
  margin-bottom:16px;
  padding:12px;
  border-radius:10px;
  font-weight:600;
  text-align:center;
}
.notification.success { background:#dcfce7; color:#065f46; }
.notification.error { background:#fee2e2; color:#b91c1c; }

.footer { text-align:center; padding:18px; font-size:14px; color:#065f46; background:#f0fdf4; }
</style>
</head>

<body>

<div class="card">
  <div class="header">
    <h1>Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©</h1>
    <p>ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø© Ù…Ù† Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</p>
  </div>

  <form id="leaveForm">
    <div class="field">
      <label>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨Ø© Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ <span>*</span></label>
      <input type="text" id="leaveName" required>
    </div>

    <div class="field">
      <label>Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© <span>*</span></label>
      <div class="radio-group">
        <label><input type="radio" name="reason" value="Ø§Ù„Ù…Ø±Ø¶" onclick="toggleOther(false)"> Ø§Ù„Ù…Ø±Ø¶</label>
        <label><input type="radio" name="reason" value="Ø§Ù„Ø³ÙØ±" onclick="toggleOther(false)"> Ø§Ù„Ø³ÙØ±</label>
        <label><input type="radio" name="reason" value="Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª" onclick="toggleOther(false)"> Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</label>
        <label><input type="radio" name="reason" value="Ø£Ø®Ø±Ù‰" onclick="toggleOther(true)"> Ø£Ø®Ø±Ù‰</label>
      </div>
      <div class="other-reason" id="otherBox">
        <input type="text" id="otherReason" placeholder="ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ¶ÙŠØ­">
      </div>
    </div>

    <div class="field">
      <label>Ù…Ù† ØªØ§Ø±ÙŠØ® <span>*</span></label>
      <input type="date" id="fromDate" required>
    </div>

    <div class="field">
      <label>Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ® <span>*</span></label>
      <input type="date" id="toDate" required>
    </div>

    <div id="msg" class="notification"></div>

    <button type="submit" id="submitBtn">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
  </form>

  <div class="footer">Ù†Ø³Ø£Ù„ Ø§Ù„Ù„Ù‡ Ø§Ù„ØªÙˆÙÙŠÙ‚ ÙˆØ§Ù„Ø³Ø¯Ø§Ø¯ ğŸŒ¿</div>
</div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbz63m4J4O_C8zZC2Lsuyvi1tMbvUz1vO4bkfi-KJQvHw9AFtsTKdBxmwSJj7j_OqnVD/exec";

// Ø¥Ø¸Ù‡Ø§Ø± / Ø¥Ø®ÙØ§Ø¡ Ø®Ø§Ù†Ø© Ø£Ø®Ø±Ù‰
function toggleOther(show){
  document.getElementById("otherBox").style.display = show ? "block" : "none";
  if (!show) document.getElementById("otherReason").value = "";
}

// Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©
function showMsg(text, type){
  const box = document.getElementById("msg");
  box.textContent = text;
  box.className = "notification " + type;
  box.style.display = "block";
  setTimeout(() => box.style.display = "none", 3000);
}

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
document.getElementById("leaveForm").addEventListener("submit", function(e){
  e.preventDefault();

  const name = leaveName.value.trim();
  const reasonRadio = document.querySelector('input[name="reason"]:checked');
  const fromDate = document.getElementById("fromDate").value;
  const toDate = document.getElementById("toDate").value;
  const btn = document.getElementById("submitBtn");

  if (!reasonRadio) {
    showMsg("âŒ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©", "error");
    return;
  }

  let reason = reasonRadio.value;
  if (reason === "Ø£Ø®Ø±Ù‰") {
    reason = document.getElementById("otherReason").value.trim();
    if (!reason) {
      showMsg("âŒ ÙŠØ±Ø¬Ù‰ ØªÙˆØ¶ÙŠØ­ Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©", "error");
      return;
    }
  }

  if (fromDate > toDate) {
    showMsg("âŒ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ³Ø¨Ù‚ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ù‡Ø§ÙŠØ©", "error");
    return;
  }

  btn.disabled = true;
  btn.textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...";
  btn.style.background = "#9ca3af";

  fetch(WEB_APP_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      action: "leave",
      name,
      reason,
      fromDate,
      toDate
    })
  })
  .then(r => r.text())
  .then(() => {
    showMsg("âœ”ï¸ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­", "success");
    e.target.reset();
    toggleOther(false);
  })
  .catch(() => showMsg("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„", "error"))
  .finally(() => {
    btn.disabled = false;
    btn.textContent = "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨";
    btn.style.background = "#065f46";
  });
});
</script>

</body>
</html>
